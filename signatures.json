{
  "base64_decode": {
    "regex": "base64_decode\\s*\\(",
    "weight": 4,
    "category": "Obfuscation",
    "description": "Base64 decoding often used to conceal payloads.",
    "example": "eval(base64_decode($payload));"
  },
  "gzinflate_decode": {
    "regex": "gzinflate\\s*\\(",
    "weight": 4,
    "category": "Obfuscation",
    "description": "Gzinflate decompression used to unpack hidden code."
  },
  "rot13_decode": {
    "regex": "str_rot13\\s*\\(",
    "weight": 3,
    "category": "Obfuscation",
    "description": "ROT13 encoding used to obscure strings."
  },
  "variable_variables": {
    "regex": "\\${\\$[A-Za-z_]+}",
    "weight": 3,
    "category": "Obfuscation",
    "description": "Dynamic variable names can indicate code obfuscation."
  },
  "packed_payload": {
    "regex": "eval\\s*\\(\\s*(gzuncompress|gzinflate|base64_decode)",
    "weight": 5,
    "category": "Obfuscation",
    "description": "Nested decoding and eval detected — likely packed malware."
  },
  "hex_encoded_strings": {
    "regex": "\\\\x[0-9a-fA-F]{2}",
    "weight": 3,
    "category": "Obfuscation",
    "description": "Hex-encoded byte sequences common in hidden payloads."
  },
  "long_string_concat": {
    "regex": "(\\.[A-Za-z0-9_\"']{10,}\\.){3,}",
    "weight": 2,
    "category": "Obfuscation",
    "description": "Suspicious string concatenation possibly reconstructing hidden code."
  },

  "eval_usage": {
    "regex": "eval\\s*\\(",
    "weight": 5,
    "category": "Code Execution",
    "description": "Direct eval() execution of arbitrary code."
  },
  "assert_execution": {
    "regex": "assert\\s*\\(",
    "weight": 5,
    "category": "Code Execution",
    "description": "assert() can evaluate expressions; abused for hidden execution."
  },
  "preg_replace_e": {
    "regex": "preg_replace\\s*\\(.*?/e.*?\\)",
    "weight": 4,
    "category": "Code Execution",
    "description": "Deprecated /e modifier allows code execution."
  },
  "create_function": {
    "regex": "create_function\\s*\\(",
    "weight": 3,
    "category": "Code Execution",
    "description": "Dynamic anonymous function creation used in injected payloads."
  },
  "backtick_exec": {
    "regex": "`[^`]+`",
    "weight": 5,
    "category": "Command Execution",
    "description": "Backtick operator executes shell commands."
  },
  "system_exec": {
    "regex": "(system|exec|shell_exec|passthru)\\s*\\(",
    "weight": 5,
    "category": "Command Execution",
    "description": "Direct OS-level command execution detected."
  },
  "proc_open_usage": {
    "regex": "proc_open\\s*\\(",
    "weight": 4,
    "category": "Command Execution",
    "description": "Low-level process execution, rarely legitimate."
  },
  "popen_usage": {
    "regex": "popen\\s*\\(",
    "weight": 3,
    "category": "Command Execution",
    "description": "Process opening function, check for misuse."
  },

  "remote_include": {
    "regex": "(include|require)(_once)?\\s*\\(.*(http|https|ftp)",
    "weight": 5,
    "category": "Injection / Remote Include",
    "description": "Remote file inclusion — critical security risk."
  },
  "file_get_remote": {
    "regex": "(file_get_contents|fopen)\\s*\\(.*(http|https)",
    "weight": 4,
    "category": "Remote Request",
    "description": "Fetching remote data via HTTP — check for malicious sources."
  },
  "curl_remote": {
    "regex": "curl_exec\\s*\\(",
    "weight": 3,
    "category": "Remote Request",
    "description": "Remote cURL execution — validate target URLs."
  },
  "socket_usage": {
    "regex": "fsockopen\\s*\\(",
    "weight": 4,
    "category": "Remote Request",
    "description": "Network socket used — may signal reverse shell or beacon."
  },
  "dns_tunnel": {
    "regex": "(dns_get_record|gethostbyname)\\s*\\(",
    "weight": 2,
    "category": "Remote Request",
    "description": "Possible C2 beaconing or domain lookups by malware."
  },

  "file_put_remote": {
    "regex": "file_put_contents\\s*\\(.*(http|ftp)",
    "weight": 4,
    "category": "File Manipulation",
    "description": "Writing remote data to disk — potential dropper."
  },
  "file_upload_move": {
    "regex": "move_uploaded_file\\s*\\(",
    "weight": 3,
    "category": "File Manipulation",
    "description": "File upload handler — review for unrestricted uploads."
  },
  "unlink_usage": {
    "regex": "unlink\\s*\\(",
    "weight": 2,
    "category": "File Manipulation",
    "description": "Deletes files — ensure not used maliciously."
  },
  "chmod_unsafe": {
    "regex": "chmod\\s*\\(.*0777",
    "weight": 3,
    "category": "File Manipulation",
    "description": "Permission escalation to world-writable detected."
  },

  "wp_ajax_nopriv": {
    "regex": "add_action\\s*\\(\\s*['\"]wp_ajax_nopriv_",
    "weight": 3,
    "category": "WordPress Security",
    "description": "Unrestricted AJAX endpoint — review for backdoor use."
  },
  "wp_eval_post": {
    "regex": "eval\\s*\\(\\s*\\$_(POST|GET|REQUEST)",
    "weight": 5,
    "category": "WordPress Exploit",
    "description": "Executes user input via eval — critical compromise signature."
  },
  "wp_option_injection": {
    "regex": "\\$wpdb->query\\s*\\(.*UPDATE\\s+wp_options",
    "weight": 4,
    "category": "WordPress Database",
    "description": "Direct wp_options manipulation — check for URL or admin_email hijacks."
  },
  "wp_nonce_bypass": {
    "regex": "check_admin_referer\\s*\\(\\s*['\"]['\"]\\s*\\)",
    "weight": 3,
    "category": "WordPress Security",
    "description": "Nonce validation disabled — unsafe in admin actions."
  },
  "wp_backdoor_user": {
    "regex": "wp_create_user\\s*\\(\\s*['\"][A-Za-z0-9_]+['\"],\\s*['\"][A-Za-z0-9_]+['\"]",
    "weight": 5,
    "category": "WordPress Backdoor",
    "description": "Creates new WordPress user via injected code."
  },

  "php_mail_injection": {
    "regex": "mail\\s*\\(.*\\$_(POST|GET|REQUEST)",
    "weight": 4,
    "category": "Abuse / Spamming",
    "description": "Mail function taking user input — potential spam relay."
  },
  "smtp_backdoor": {
    "regex": "PHPMailer|Swift_Mailer|mail\\s*\\(.*base64_decode",
    "weight": 3,
    "category": "Abuse / Spamming",
    "description": "Mailer libraries or encoded payloads — inspect for spam backdoors."
  },

  "webshell_auth_gate": {
    "regex": "\\$_(POST|GET|REQUEST)\\s*\\[\\s*['\"](pass|pwd|key|access)['\"]\\s*\\]",
    "weight": 5,
    "category": "Webshell",
    "description": "Password-protected webshell access parameter detected."
  },
  "webshell_eval": {
    "regex": "eval\\s*\\(\\s*\\$_(POST|GET|REQUEST)",
    "weight": 5,
    "category": "Webshell",
    "description": "Evaluates user input — hallmark of PHP webshells."
  },
  "webshell_write": {
    "regex": "file_put_contents\\s*\\(\\s*\\$_(POST|GET|REQUEST)",
    "weight": 5,
    "category": "Webshell",
    "description": "Writes user-supplied data to disk — possible webshell dropper."
  },
  "webshell_cmd": {
    "regex": "(cmd|shell|execute|command)\\s*\\(",
    "weight": 5,
    "category": "Webshell",
    "description": "Command handler functions typical of custom webshells."
  },
  "webshell_ua_trigger": {
    "regex": "\\$_SERVER\\s*\\[\\s*['\"]HTTP_USER_AGENT['\"]\\s*\\]",
    "weight": 3,
    "category": "Webshell",
    "description": "Checks for user agent — may be used as trigger for hidden access."
  },

  "hidden_iframe": {
    "regex": "<iframe[^>]+style=\\s*['\"][^>]*display:\\s*none",
    "weight": 3,
    "category": "HTML Injection",
    "description": "Hidden iframe injection signature."
  },
  "javascript_obfuscation": {
    "regex": "eval\\s*\\(\\s*String\\.fromCharCode",
    "weight": 4,
    "category": "JavaScript Obfuscation",
    "description": "Decoded JavaScript payload execution via eval."
  },
  "jquery_injected_remote": {
    "regex": "\\$.getScript\\s*\\(\\s*['\"]http",
    "weight": 3,
    "category": "JavaScript Injection",
    "description": "Remote JavaScript injection — check source domain."
  },
  "meta_refresh_redirect": {
    "regex": "<meta[^>]+http-equiv=['\"]refresh",
    "weight": 2,
    "category": "HTML Injection",
    "description": "Meta refresh redirect, often used in SEO or phishing injections."
  }
}
